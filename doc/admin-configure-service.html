<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ANNIS: Configure back-end service</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="annis_64.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ANNIS
   &#160;<span id="projectnumber">3.1.7</span>
   </div>
   <div id="projectbrief">An open source, versatile web browser-based search and visualization architecture for complex multilevel linguistic corpora with diverse types of annotation.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('admin-configure-service.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Configure back-end service </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#admin-configure-user">User Configuration </a><ul><li class="level2"><a href="#admin-configure-userfileloc">Configuration file location </a></li>
<li class="level2"><a href="#admin-configure-userformat">User and group files </a><ul><li class="level3"><a href="#admin-configure-anonymous">anonymous group</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#admin-configure-contextsize">Changing maximal context size </a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="admin-configure-user"></a>
User Configuration </h1>
<p>ANNIS has an authentication system which allows to handle multiple users which will see different corpora depending on which groups the user is part of. Behind the scenes ANNIS uses the <a href="http://shiro.apache.org/">Apache Shiro</a> security framework. Per default ANNIS uses a file based authentication and authorization approach where some configuration files with an ANNIS specific layout are evaluated. This section will discuss how to manage this configuration. Additionally, the administrator can also directly adjust the contents of the conf/ shiro.ini configuration file. This allows a much more individual configuration and the usage of external authorization services like LDAP.</p>
<h2><a class="anchor" id="admin-configure-userfileloc"></a>
Configuration file location </h2>
<p>There is a central location where the user configuration files are stored. Configure the path to this location in the <code>conf/shiro.info</code> configuration file of the ANNIS service. The default path is <code>/etc/annis/user_config/</code> and must be changed at two locations in the configuration file.</p>
<pre class="fragment">[main]
annisRealm = annis.security.ANNISUserRealm
annisRealm.resourcePath=/etc/annis/user_config/
annisRealm.authenticationCachingEnabled = true
globalPermResolver = annis.security.ANNISRolePermissionResolver
globalPermResolver.resourcePath = /etc/annis/user_config/
</pre><h2><a class="anchor" id="admin-configure-userformat"></a>
User and group files </h2>
<ol type="1">
<li>Create a file "groups" in the user-configuration directory (e.g. <code>/etc/annis/user_config/groups</code>): <pre class="fragment">group1=pcc3,falko,tiger2
group2=pcc3
group3=tiger1
anonymous=pcc2,falko
</pre> This example means that a member of group group1 will have access to corpora with the names pcc3,falko, tiger2 (corpus names can be displayed with the <code>annis-admin.sh list</code> command).</li>
<li>Create a subdirectory <code>users</code></li>
<li><p class="startli">You have to create a file for each user inside the users subdirectory where the user's name is <em>exactly</em> the file name (no file endings). </p>
<pre class="fragment">groups=group1,group3
password=$shiro1$SHA-256$1$tQNwUIxEQhrDn6FKcY1yNg==$Xq8ZCb3RFBwn3GfQ7pav3G3vHg4TKRGD1ItpfdW+JvI=
given_name=userGivenName
surname=userSurname
</pre><ul>
<li>A superuser who has access to every corpus can be created with <code>groups=*</code></li>
<li><code>given_name</code> and <code>surname</code> can contain any string</li>
<li>The password must be hashed with SHA256 (one iteration and using a Salt) and formatted in the <a href="http://shiro.apache.org/static/current/
apidocs/org/apache/shiro/crypto/hash/format/Shiro1CryptFormat.html">Shiro1CryptFormat</a>.</li>
</ul>
<p class="startli">The easiest way to generate the passwort hash is to use the Apache Shiro command line hasher (<a href="http://shiro.apache.org/command-line-hasher.html">http://shiro.apache.org/command-line-hasher.html</a>) which can be downloaded from <a href="http://shiro.apache.org/download.html#Download-1.2.1.BinaryDistribution">http://shiro.apache.org/download.html#Download-1.2.1.BinaryDistribution</a> .</p>
<ol type="a">
<li>Execute <code>java -jar shiro-tools-hasher-1.2.1-cli.jar -i 1 -p</code> from the command line (the jar-file must be in the working directory)</li>
<li>Type the password</li>
<li>Retype the password</li>
<li>It will produce the following output: <div class="fragment"><div class="line">$ java -jar shiro-tools-hasher-1.2.1-cli.jar -i 1 -p</div>
<div class="line">Password to hash: </div>
<div class="line">Password to hash (confirm): </div>
<div class="line">$shiro1$SHA-256$1$kRMX+Et6w7XJgwSEAgq9nw==$sQOgObXsQdO76wnNxvN0aesvTSPoBsd/2bjxasydB+I=</div>
</div><!-- fragment --> The last line is what you have to insert into the password field.</li>
</ol>
</li>
</ol>
<h3><a class="anchor" id="admin-configure-anonymous"></a>
anonymous group</h3>
<p>The special group <code>anonymous</code> is used for non logged-in users. Thus every corpus listed here is available for everyone without (and with) login.</p>
<h1><a class="anchor" id="admin-configure-contextsize"></a>
Changing maximal context size </h1>
<p>The maximal context size of ±n tokens from each search result (for the KWIC view, but also for other visualization) can be set for the ANNIS service in the file <code>&lt;service-home&gt;/conf/annis-service.properties</code> Using the syntax, e.g. for a maximum context of 10 tokens: </p>
<pre class="fragment">annis.max-context=10
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="admin.html">Administration</a></li>
    <li class="footer">Generated on Wed Jul 9 2014 19:36:47 for ANNIS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
